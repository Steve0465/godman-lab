#!/usr/bin/env python3
"""Test AT&T Billing API with fresh cookies."""
import json
from pathlib import Path
from libs.att_billing_api import ATTBillingAPI

# Fresh cookies from browser
browser_cookies = [{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"akaalb_prod_onprem","httpOnly":True,"storeId":None,"value":"~op=prod_onprem_alb:prod-idp-aldc2|~rv=74~m=prod-idp-aldc2:0|~os=c2e53dcabb81922a188c759e7de57e2b~id=f224e168e8988f3214f28fcf6e07ea98","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"UUID","expirationDate":1800168123,"httpOnly":False,"storeId":None,"value":"157992132","session":False,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"gtmgrph","httpOnly":False,"storeId":None,"value":"aze2","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"dtPC","httpOnly":False,"storeId":None,"value":"5$435056877_153h-vHMSCIADNAEMBTVMNPHRSAVPWAHVUFVUE-0e0","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":False,"hostOnly":True,"name":"att billing page","httpOnly":False,"storeId":None,"value":"","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"dtCookie","httpOnly":False,"storeId":None,"value":"v_4_srv_5_sn_3E211E55E85986EDE7C927BE6C9648A2_app-3A7e91229232cd3329_1_app-3Aa75ea7b2824f5aea_1_ol_0_perc_100000_mul_1","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"Kd4zPCrb","expirationDate":1800194300,"httpOnly":False,"storeId":None,"value":"A0mCcRabAQAAmVSpzKWB1ZOgFJSh7ggsSM3J6n8e1HP1XBxrMO4hr2PlCj3pAUssfgb6K-mbrJNeCOfvosJeCA|1|0|4d8b60157877c139fd25cd5917fe6fa11a137653","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"kndctr_55633F7A534535110A490D44_AdobeOrg_cluster","expirationDate":1765636857,"httpOnly":False,"storeId":None,"value":"va6","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"bm_mi","expirationDate":1765641493,"httpOnly":False,"storeId":None,"value":"8E894CD2A30F47611AD3416C6AF788A0~YAAQZ1XIFywgNwSbAQAA8UoBGB42e68lHD8lWj4qfLf9RWP3OKJ9K6ofH/7BewsXj7SPIF6OoJT1FivrzPlF5kJ4ZMfuFJCJnhB9PwAOPyXtVsbUUesMF8jOO1Xj+NoEKcZoaXGFjuEVwc3tIfDZR4WEK7LcoTJWVKTd51pIr8k2lTE0Ab6MsytXcVtMdGt3kLgjKjBT9Bv04lksllDIoAfb7UixygCJabeXa/yUl0wIOIOwavNRI0qMcxjbuV4Rnjg3K2EiKaF44NHfUg13dPfg8Hj4+SfSyxsHkfnprJ9dOGZZ8GfgnBNXlS6USHUY3ulIq5MZmxwPUwv5WjqSmNijbguHz90wo9gGNxY=~1","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"uws_inviteShown","expirationDate":1766239978,"httpOnly":False,"storeId":None,"value":"%22true%22%7C1768200426062","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"mbox","expirationDate":1766239857,"httpOnly":False,"storeId":None,"value":"session%2335623819303053795431075402560036642541%2DCedlPN%231765636917","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"s_ecid","expirationDate":1766212866,"httpOnly":False,"storeId":None,"value":"MCMID%7C35623819303053795431075402560036642541","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"azure_ssaf_stack","httpOnly":False,"storeId":None,"value":"ssafeastus2","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"__eoi","expirationDate":1781160140,"httpOnly":False,"storeId":None,"value":"ID=39356f063481edef:T=1765608140:RT=1765635059:S=AA-AfjbakHvy0lG1ADMTulqHmXcY","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"dtSa","httpOnly":False,"storeId":None,"value":"-","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"uws_prop_ui9uufma","expirationDate":1765636978,"httpOnly":False,"storeId":None,"value":"%22n%22%7Csession_timeout","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"_abck","expirationDate":1797171069,"httpOnly":False,"storeId":None,"value":"C97B5626497789EFF80E9ECE765B3DAF~0~YAAQblXIF9YKfceaAQAAnBUNGA+6TxN/eK1uQb5pvK2vrDyDCVjSBn8N74u9RcbRL3Z6RpTMjuqKsSmcHyipCAjnpr/SAH3/rh+taon2f74iLipxlItynIMvmRi3FR5GWVfYU4n3NUiupWKhg2Ill59b07I3RQEXMV0pzyh4PNf6LYdAymOZOQkfyrtmZ7PnZ5BjMkj1IprIZagbuFo2od66xSK5nEQwR2vcDEyWN0Uk5JfemME0z4deAmpiuEg7TvNkLsHkiRFJW3MdCvIbk25zQ5bvyztSGQ+nD0eIdcPPghAoE+ysmuF6L9PP0EWlUnKbLCwE5odsw9kXEBgFrJguC0zVnQi5JQhXpf0EuYXvARFdmXIDWp87QJqeQ2KrzZ6KEnWOTALR3sCWm0lMmxmE25FyHBGpUYrUpgs24JzudtgrNS4cEMIZVzFcf74w3C9FGjgd0il22vKlOYpJacJbGkAohNHuxvxogsJtqmPAKrZsYwDEC0oUgXMD/Z3jx1pDGCQjrBn9ScpHQ/G+cdN4mJy0gPiUS7GMZ/bdC8+KXqI7Sb3Ms3D87mrfbx+6y/eJ84z3IcsVxEFGQdyyGaSluVGSR2+Sa4D2j80epohHfmeuvGzeSAqpqqjxA3YK6FK9pLFgnuYhxKUp/kq6JWGWU59H9KSHvBBezHeH5+hGi2moefBCuKep9A9oS6oiUxXXHwq/NxwmA93cPXr8mad7VKP+3aVnpqs2PfDCyToG7VC656NNOlPoKrQ0IsfR2PUVu1m+mVFjvhJr9gvqS90kcDTE6EY/1aI+X15yVSkAuwypcMwVR8GlPJR7dGJi85f9AH1f~-1~-1~1765637895~AAQAAAAE%2f%2f%2f%2f%2f9Th0VFzy6m0TBXOyZ22PfLm0nR0n4esLhOqvU3giB1scXiLKQ64frSpPcC3eagW8vXETdXDIAqUbnZDPmHZL8viU5f5UOVjJxbEGch8kSnOk%2fQqkdylc2oyfUyAmfB38bGBXKo%3d~-1","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"__gads","expirationDate":1799304140,"httpOnly":False,"storeId":None,"value":"ID=65e9bf3dadb9cccf:T=1765608140:RT=1765635059:S=ALNI_MZi6q-bToiXx3IegrzLH_phk4LN1w","session":False,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"akaalb_prod_upperfunnel","httpOnly":True,"storeId":None,"value":"~op=prod_upperfunnel_alb:prod-upperfunnel-azw2|~rv=49~m=prod-upperfunnel-azw2:0|~os=c2e53dcabb81922a188c759e7de57e2b~id=6b41693f76712d81f7f7e56eed4a5480","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"idpmgw","httpOnly":True,"storeId":None,"value":"eyJjcyI6IkF1dGgiLCJjc1RrIjoiZmY2YmQyODVkMDJlZGNiMDJmNDgyM2MyMjhlMGZjNjNmODJkZDY5OSIsInNpZCI6IjVhNTEwNjIwLWZiNzgtNGQxOC1hODIxLTc5NjJkY2JlODNiYSIsImlhdCI6MTc2NTYzNTA1OSwiZXhwIjoxNzY1NjM2ODU5LCJ0b2tlblR5cGUiOiJIQUxPIiwidGF0c1JlcyI6InNyM3A0SEttMFJzc1pPbzFISlpTaXEvQ1Z3RmxURlhJblB0SjZUaXNaeHg1N2JWVTVUZlJocm9BUTc2MHU5ZERWYXVZRCs2eE9WOTJ4ZnpibjgzclIrUFpNcDlZbXQ4OU9QWXBzelQrQ3BhTXl0QVl0Mi9ienV5Q2JVVnZ3c1pxZytXNFg5RFFDYjVZbHdIWENxMWh3OE05eFp0SHNBUEgxeG5sbTF1bVNVMENvUzZBMlZaVEtic3d2K29vK2RsL09XakU4Z2paV3BDcmRzSnA1cGs0cUFhWWRsYXREQWFaWVliTk43ZXJ2UFdHUitQdGFNalNhZEZlMkdBRTNYVEFaZEVLS1VYMXlsMnE4bDRvWGRsT2o4bkYvdTl1VDJuR2JZMm9LTXpHQTlCUDlVK3hhbDgxbW5ERHN0UFVTVExySnFHaWtZV1cwOC9OMWoyai9hSHMyRXpDTFhWQmJ3VVJxQ3Q5M01SMVcvbXdEVTdSY05TaStZYmtoZjFRbFp3dVZsamFQUnJ0M3NXZFpWMnhhcHh1WjVCMC9SSDBmdmFjY1AvYTlhTndFblBuRXFTVktBOXI0dXRsR1BjK3hBYnhlYk5xcVlvR2o4cWZ2OVc5d3l5T3BIT3JPOE9hYlh6a1hOb21KczVzM3FnTVdjdVB0WExodkgzYTZPcTd2VWRtb2dnR0RaU2VGZXZCa1I4aW5ZQzJEVXB0SVd4YmxrQ3RVVk9mNkFsd3NtT1RHQU8rT2FtNUJpTnBnZTNYQXorMkZ4ME1QcEpLQm9DclpDaFVlc0NWd0hkOWRGRG8xUHlKVWhVMWVLZlpmNU00Rk1tU2J1TjdIVU9mL1B0VmlDTlZaLzZSMzBIVklpUjBISytVSmhaRXZmYzU5TDI0OUw1MGVWZnNUempzWFpKUnBYcXpXQkROSTBZdmlxMjJ2M2ZjcGptOThaVnFWYTdoZGJUY1UvaHhkY1FmODNYOHErdlZwMHgwWTV0VGFGNy9mTndRT2llTndCanZOM0pUdWNqYSIsImNvbnYtaWQiOiI1YTUxMDYyMC1mYjc4LTRkMTgtYTgyMS03OTYyZGNiZTgzYmEiLCJ0YXRzaWQiOiIyMmZkZWU1ODhjNGE0YjllMDMwYzcwYWY5ZGFmZDRiZSIsInVhdXVpZCI6IjE1Nzk5MjEzMiIsImlhdCI6MTc2NTYzNTA3NywiZXhwIjoxNzY1NjM2ODc3fQ.Vk8Ha-klQaEJPXBJJNOvRH5wjz0QA_3kjZ4E40sY34o","session":True,"path":"/","sameSite":"lax"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"bm_sv","expirationDate":1765641495,"httpOnly":False,"storeId":None,"value":"E0A6BA26889493AB5352EC8A6D63213B~YAAQblXIF2gTfceaAQAA8DQNGB5Kctz6hfyZgpa2pmT7cuCwneucrEe+dWStuKJ7+7BIBm3xlLvGbpJkKTHgIFXEiflJpfxTDIlbJ0Ac5QCt2IPm1ZQ/o3I27s0BfXNf+CDKvtZfH1IyZLQ1GELkKdKynIY6UOFVmWKd0SbcBSoSnqbxVC98IU3UsDBE0rttEqdpg+4RrrwJ+ktIcRTc/uvGJECSCE5u2G943ofivWGep9axLFQGNs5tR0nEzA==~1","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"tAuthNState","httpOnly":False,"storeId":None,"value":"true","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"mboxEdgeCluster","expirationDate":1765636857,"httpOnly":False,"storeId":None,"value":"34","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"__gpi","expirationDate":1799304140,"httpOnly":False,"storeId":None,"value":"UID=0000131b8a1a0195:T=1765608140:RT=1765635059:S=ALNI_MZIINr4a5C3Vq2rkkk8JRopU9OPvg","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"CIP","httpOnly":False,"storeId":None,"value":"75.44.126.6","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"uws_story_80bgjfd1","expirationDate":1766239978,"httpOnly":False,"storeId":None,"value":"%7B%22done%22%3Afalse%2C%22stopped%22%3Atrue%7D%7C1768200427723","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"aacState","httpOnly":False,"storeId":None,"value":"true","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"ak_bmsc","expirationDate":1765641493,"httpOnly":True,"storeId":None,"value":"6AA4C48A3D36E7AB71C0C28A4079B832~000000000000000000000000000000~YAAQZ1XIFyYhNwSbAQAAs00BGB4kS636H78n60Sq271Wa/USLKN2m+/A3AMtlDz2NS03DionoGYBxllM3WdJFAxjy6WpGdgVv1awPqJO9iVs+/qY2fXT0WiUneH86RWKUgLVCdxBDtr46ACvv1U/9PTIEYBmJ6jwUuNF36MlnNfFc2b1VKYU2ZkDjLn9kqdY8zcFljBcKH8LQCIgD0pAge+8PWJoUYIdpFhAAQpa0QnfDpUc8DFkHXdZtkpkFsSBB7g8NKJQerx24icsVmeI+1f/AVR1yLCWdK3F6ayjHtC0cwHAgYAbqamNL8juDSUSvzWxKpdCywTLVVgzO6Skl363LZGklWDFf2y09D/0DpwZDLp43EcdiTw+uzfzZAkLngw18MoA9uMzposCvsHLSzpjhMsEK0rtvk1yqAsN6kZVuLQKc08ksyUPC+Rbjq8JXFCbiRpmckHL3Jak55FFXm6axMHFpfnVidyuxaB67WQRwbvbQLd2rxo1sZgp6DhNe0Qizvo5BRJfD5Y82SM=","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"AKA_A2","expirationDate":1765637894,"httpOnly":True,"storeId":None,"value":"A","session":False,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"akaalb_prod_sales","httpOnly":True,"storeId":None,"value":"~op=prod_sales_alb:prod-sales-azw2|~rv=24~m=prod-sales-azw2:0|~os=c2e53dcabb81922a188c759e7de57e2b~id=1fa480fb54d449cc57f7a0cdec925a0a","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"AMCV_55633F7A534535110A490D44%40AdobeOrg","expirationDate":1800168066,"httpOnly":False,"storeId":None,"value":"1994364360%7CMCMID%7C35623819303053795431075402560036642541%7CMCAAMLH-1766212865%7C7%7CMCAAMB-1766212865%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1765615265s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.4.0","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"bm_sz","expirationDate":1765648693,"httpOnly":False,"storeId":None,"value":"A01E47ECC1554B3D452821FCEBFFD671~YAAQblXIF+H/fMeaAQAATOsMGB7lV5ypeI+qfLfjDHbf/qsME7crAGcOHOPsTn4Y42jDuj/fbzVlzKoTLFITSgvy3hX2wlqX0rDDCOGibNUiVXfqVFerIAOhPjDkzBuvVzpxkl/cGm5J1RIwuw+JnVtBJakjGW9OetNU/ukkpDfl1JWOcZM0svPrNYxEBTLAmw4gDhyghdI1THuZtkufrwy8/IKYY9PqcuOoU1gBtAfvAaGdf6G2dW6WHi8QTQGYR2I8HFAOH2+N8Kfg43/DOP9LHU9XEdh44UpaM5v/cZi02FvwBtHxWStpKkv7r45O1BKyaRd29Jzdp7kCzGNBrtaylpPbmnVGJYWdSAfz1BLIiv+J9XDXJu39EF5IL3Vr0E1oUKSDKTrFql2kTFrPJiiiJz7dYIusj4l+xnGUyzMddYjRXdhsbuixshhjwuEYaiWsD5Pqv/nGv6lQc4fFB3wORp6CskzB/NQIy79f25Wn39+IxEikVADKtT82TmHv7d/bc7qeGHKTXQ==~3290160~3163202","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"c_d_state","httpOnly":False,"storeId":None,"value":"AAAAEGuAcgX_C7SEodzvodp6TEnGOoYJSRh4MvPFlLtVoMGNEpQWXaHd3502kZnTM_GRrFgsO4o4fImZdo8bew0X74H42XL5kU7Er7D7qoeschEcqmYPcZxNMYiTeCq7bx5_q-TUbwyjx8hvi22_1BBRCrUG_2JLV_H67pD4ZpWQf540OV1jALs-PzVo5ukXFzOWtUO761EBu20IlU9FtVBuo2DRYjqdx9Y","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"c_p_browser_refID","expirationDate":1781186316,"httpOnly":True,"storeId":None,"value":"uVSyFYbxMSZXwajI5uufFhoRp/7H2b3siEIHeeguqoI=","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"cAuthNState","httpOnly":False,"storeId":None,"value":"memphis465@hotmail.com@slid.dum:1765637910536:en","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":False,"hostOnly":True,"name":"ftalking","httpOnly":False,"storeId":None,"value":"ftrackid:fdde8f6ea5f44c82b61213c8e5d6701e|","session":True,"path":"/acctmgmt","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"gtmacct","httpOnly":False,"storeId":None,"value":"azw2","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"gtmmisc","httpOnly":False,"storeId":None,"value":"aze2","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"gtmpno","httpOnly":False,"storeId":None,"value":"aze2","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"gtmps","httpOnly":False,"storeId":None,"value":"ffdc","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"gtmsales","httpOnly":False,"storeId":None,"value":"azw2","session":True,"path":"/","sameSite":"no_restriction"},{"domain":"www.att.com","secure":True,"hostOnly":True,"name":"gtmuf","httpOnly":False,"storeId":None,"value":"azw2","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"halologinstate","expirationDate":1765635217,"httpOnly":False,"storeId":None,"value":"%7B%22final_url%22%3A%5B%5D%2C%22cauthnstate%22%3A%22memphis465%40hotmail.com%40slid.dum%3A1765637910536%3Aen%22%2C%22cid%22%3A%22m14186%22%7D","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"ixp","expirationDate":1800195036,"httpOnly":True,"storeId":None,"value":"71a42331-e25c-44ae-9a88-d1afd629fdda","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"kndctr_55633F7A534535110A490D44_AdobeOrg_identity","expirationDate":1766212866,"httpOnly":False,"storeId":None,"value":"CiYzNTYyMzgxOTMwMzA1Mzc5NTQzMTA3NTQwMjU2MDAzNjY0MjU0MVIQCICYxLOxMxgBKgNWQTYwA%5FABgJjEs7Ez","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"QuantumMetricSessionID","expirationDate":1765636998,"httpOnly":False,"storeId":None,"value":"456e8d3b68f041652dd024650130825e","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"QuantumMetricUserID","expirationDate":1797171059,"httpOnly":False,"storeId":None,"value":"329027c795d2252d6aed54f77eb93aad","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"rxVisitor","expirationDate":1800195079,"httpOnly":False,"storeId":None,"value":"1765608065370CBC3B73BF0GNTNG6HSLL7GFJRDGVBO77","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"rxvt","httpOnly":False,"storeId":None,"value":"1765636876033|1765634294658","session":True,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"uws_ab_test","expirationDate":1765636978,"httpOnly":False,"storeId":None,"value":"25%7Csession_timeout","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"uws_rate_comparators","expirationDate":1765636978,"httpOnly":False,"storeId":None,"value":"%7B%22global%22%3A61586242%7D%7Csession_timeout","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"uws_session","expirationDate":1765636978,"httpOnly":False,"storeId":None,"value":"%7B%22start%22%3A1765634296131%2C%22count%22%3A7%2C%22referrer%22%3A%22%22%7D%7Csession_timeout","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"uws_storage","expirationDate":1766239858,"httpOnly":False,"storeId":None,"value":"%22cookie%22","session":False,"path":"/","sameSite":"no_restriction"},{"domain":".att.com","secure":True,"hostOnly":False,"name":"uws_visitor","expirationDate":1766239978,"httpOnly":False,"storeId":None,"value":"%7B%22vid%22%3A%22176560806707960731%22%2C%22start%22%3A1765608067079%2C%22count%22%3A13%7D%7C1773411058635","session":False,"path":"/","sameSite":"no_restriction"}]

print(f"Converting {len(browser_cookies)} cookies...")

# Convert to Playwright format
cookies = []
for c in browser_cookies:
    cookie = {
        "name": c["name"],
        "value": c["value"],
        "domain": c["domain"],
        "path": c["path"],
        "httpOnly": c.get("httpOnly", False),
        "secure": c.get("secure", False),
    }
    if not c.get("session", False) and c.get("expirationDate"):
        cookie["expires"] = c["expirationDate"]
    
    ss = c.get("sameSite", "no_restriction")
    cookie["sameSite"] = "Lax" if ss == "lax" else ("Strict" if ss == "strict" else "None")
    
    cookies.append(cookie)

# Save cookies
cookie_file = Path(".cache/att_cookies.json")
cookie_file.parent.mkdir(exist_ok=True)
with open(cookie_file, "w") as f:
    json.dump(cookies, f, indent=2)

print(f"✓ Saved {len(cookies)} cookies to {cookie_file}")
print()

# Test API immediately
print("Testing AT&T Billing API...")
print("=" * 70)

try:
    with ATTBillingAPI() as api:
        # Test 1: Current Balance
        print("\n1. Current Balance:")
        try:
            balance = api.get_current_balance()
            print("   ✅ SUCCESS!")
            print(f"   Balance: ${balance.get('currentDueAmount', 'N/A')}")
            print(f"   Due Date: {balance.get('dueDate', 'N/A')}")
        except Exception as e:
            print(f"   ❌ FAILED: {e}")
        
        # Test 2: Activity History
        print("\n2. Activity History:")
        try:
            activity = api.get_activity_history()
            print("   ✅ SUCCESS!")
            items = activity.get("activityList", [])
            print(f"   Found {len(items)} activity items")
            if items:
                print(f"   Latest: {items[0].get('description', 'N/A')}")
        except Exception as e:
            print(f"   ❌ FAILED: {e}")
        
        # Test 3: Bill History
        print("\n3. Bill History:")
        try:
            history = api.get_bill_history()
            print("   ✅ SUCCESS!")
            print(f"   Billing cycles: {len(history.get('billHistory', []))}")
        except Exception as e:
            print(f"   ❌ FAILED: {e}")

    print("\n" + "=" * 70)
    print("✓ All tests complete!")

except Exception as e:
    print(f"\n❌ Test suite failed: {e}")
    import traceback
    traceback.print_exc()
